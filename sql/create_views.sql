CREATE ALGORITHM=UNDEFINED DEFINER=`username`@`%` SQL SECURITY DEFINER VIEW `competition_summary` AS (select `total`.`team` AS `team`,`total`.`s_id` AS `s_id`,`total`.`c_id` AS `c_id`,sum(`total`.`P`) AS `P`,sum(`total`.`W`) AS `W`,sum(`total`.`D`) AS `D`,sum(`total`.`L`) AS `L`,sum(`total`.`F`) AS `F`,sum(`total`.`A`) AS `A`,sum(`total`.`GD`) AS `GD`,sum(`total`.`PTS`) AS `PTS`,sum(`total`.`HP`) AS `HP`,sum(`total`.`HW`) AS `HW`,sum(`total`.`HD`) AS `HD`,sum(`total`.`HL`) AS `HL`,sum(`total`.`HF`) AS `HF`,sum(`total`.`HA`) AS `HA`,sum(`total`.`HGD`) AS `HGD`,sum(`total`.`HPTS`) AS `HPTS`,sum(`total`.`AP`) AS `AP`,sum(`total`.`AW`) AS `AW`,sum(`total`.`AD`) AS `AD`,sum(`total`.`AL`) AS `AL`,sum(`total`.`AF`) AS `AF`,sum(`total`.`AA`) AS `AA`,sum(`total`.`AGD`) AS `AGD`,sum(`total`.`APTS`) AS `APTS` from (select `matches`.`s_id` AS `s_id`,`matches`.`c_id` AS `c_id`,`matches`.`home_t` AS `team`,1 AS `P`,if((`matches`.`hg` > `matches`.`ag`),1,0) AS `W`,if((`matches`.`hg` = `matches`.`ag`),1,0) AS `D`,if((`matches`.`hg` < `matches`.`ag`),1,0) AS `L`,`matches`.`hg` AS `F`,`matches`.`ag` AS `A`,(`matches`.`hg` - `matches`.`ag`) AS `GD`,(case when (`matches`.`hg` > `matches`.`ag`) then 3 when (`matches`.`hg` = `matches`.`ag`) then 1 else 0 end) AS `PTS`,1 AS `HP`,if((`matches`.`hg` > `matches`.`ag`),1,0) AS `HW`,if((`matches`.`hg` = `matches`.`ag`),1,0) AS `HD`,if((`matches`.`hg` < `matches`.`ag`),1,0) AS `HL`,`matches`.`hg` AS `HF`,`matches`.`ag` AS `HA`,(`matches`.`hg` - `matches`.`ag`) AS `HGD`,(case when (`matches`.`hg` > `matches`.`ag`) then 3 when (`matches`.`hg` = `matches`.`ag`) then 1 else 0 end) AS `HPTS`,0 AS `AP`,0 AS `AW`,0 AS `AD`,0 AS `AL`,0 AS `AF`,0 AS `AA`,0 AS `AGD`,0 AS `APTS` from `apps_schema`.`matches` union all select `matches`.`s_id` AS `s_id`,`matches`.`c_id` AS `c_id`,`matches`.`away_t` AS `away_t`,1 AS `1`,if((`matches`.`hg` < `matches`.`ag`),1,0) AS `if (hg < ag, 1, 0)`,if((`matches`.`hg` = `matches`.`ag`),1,0) AS `if (hg = ag, 1, 0)`,if((`matches`.`hg` > `matches`.`ag`),1,0) AS `if (hg > ag, 1, 0)`,`matches`.`ag` AS `ag`,`matches`.`hg` AS `hg`,(`matches`.`ag` - `matches`.`hg`) AS `ag-hg`,(case when (`matches`.`hg` < `matches`.`ag`) then 3 when (`matches`.`hg` = `matches`.`ag`) then 1 else 0 end) AS `case when hg < ag then 3 when hg = ag then 1 else 0 end`,0 AS `0`,0 AS `0`,0 AS `0`,0 AS `0`,0 AS `0`,0 AS `0`,0 AS `0`,0 AS `0`,1 AS `AP`,if((`matches`.`hg` < `matches`.`ag`),1,0) AS `AW`,if((`matches`.`hg` = `matches`.`ag`),1,0) AS `AD`,if((`matches`.`hg` > `matches`.`ag`),1,0) AS `AL`,`matches`.`ag` AS `ag`,`matches`.`hg` AS `hg`,(`matches`.`ag` - `matches`.`hg`) AS `ag-hg`,(case when (`matches`.`hg` < `matches`.`ag`) then 3 when (`matches`.`hg` = `matches`.`ag`) then 1 else 0 end) AS `case when hg < ag then 3 when hg = ag then 1 else 0 end` from `apps_schema`.`matches`) `total` group by `total`.`team`,`total`.`s_id`,`total`.`c_id` order by sum(`total`.`PTS`) desc);

CREATE ALGORITHM=UNDEFINED DEFINER=`username`@`%` SQL SECURITY DEFINER VIEW `matches` AS select `mt`.`M_ID` AS `m_id`,`mt`.`S_ID` AS `s_id`,`mt`.`FDATE` AS `fdate`,`ct`.`name` AS `name`,`ct`.`c_id` AS `c_id`,(select `tt`.`name` from `team_tab` `tt` where (`mt`.`HT_ID` = `tt`.`t_id`)) AS `home_t`,(select `tt`.`name` from `team_tab` `tt` where (`mt`.`AT_ID` = `tt`.`t_id`)) AS `away_t`,`mt`.`HG` AS `hg`,`mt`.`AG` AS `ag` from (`match_tab` `mt` join `competition_tab` `ct`) where (`mt`.`C_ID` = `ct`.`c_id`);

CREATE ALGORITHM=UNDEFINED DEFINER=`username`@`%` SQL SECURITY DEFINER VIEW `people` AS select `pt`.`P_ID` AS `p_id`,`pt`.`FNAME` AS `fname`,`pt`.`LNAME` AS `lname`,`pt`.`NATIONALITY` AS `nationality`,`pt`.`BIRTH` AS `birth`,`pt`.`ROLE` AS `role`,`pt`.`SUBROLE` AS `subrole`,`pt`.`T_ID` AS `t_id`,`tt`.`name` AS `t_name`,`pnt`.`BBC` AS `bbc`,`pnt`.`n1` AS `n1`,`pnt`.`n2` AS `n2`,`pnt`.`n3` AS `n3`,`pnt`.`n4` AS `n4`,`pnt`.`n5` AS `n5` from ((`people_tab` `pt` join `people_names_tab` `pnt`) join `team_tab` `tt`) where ((`pt`.`P_ID` = `pnt`.`P_ID`) and (`pt`.`T_ID` = `tt`.`t_id`));

CREATE ALGORITHM=UNDEFINED DEFINER=`username`@`%` SQL SECURITY DEFINER VIEW `team` AS select `cdt`.`det_id` AS `det_id`,`st`.`s_id` AS `s_id`,`st`.`season` AS `season`,`ct`.`name` AS `competition`,`tt`.`t_id` AS `t_id`,`tt`.`name` AS `name`,`tt`.`city` AS `city`,`tnt`.`N1` AS `n1`,`tnt`.`N2` AS `n2`,`tnt`.`N3` AS `n3`,`tnt`.`N4` AS `n4` from ((((`team_tab` `tt` join `team_names_tab` `tnt`) join `season_tab` `st`) join `competition_tab` `ct`) join `competition_details_tab` `cdt`) where ((`cdt`.`s_id` = `st`.`s_id`) and (`cdt`.`c_id` = `ct`.`c_id`) and (`cdt`.`t_id` = `tt`.`t_id`) and (`cdt`.`t_id` = `tnt`.`t_id`));
